{% extends "pagination/head.html" %}

{% block table %}
          {% if port_status %}
          <p>{{ daterange }}</p>
              <h3>
                <a href="{% url 'table' %}?ip={{ ip }}&port={{ port }}">{{ ip }} : {{ port }}</a>
              </h3>

              <form action="{% url 'table' %}">
                <input type="text" name="daterange" />
                <input type="hidden" id="ip" name="ip" value="{{ ip }}">
                <input type="hidden" id="port" name="port" value="{{ port }}">
                  <script>
                    $(function() {
                      $('input[name="daterange"]').daterangepicker({
                        timePicker: true,
                        timePickerSeconds: true,
                        timePicker24Hour: true,
                        startDate: moment().startOf('hour'),
                        endDate: moment().startOf('hour').add(32, 'hour'),
                        locale: {
                          format: 'DD-MM-YYYY HH:mm:ss'
                        }
                      });
                    });
                  </script>
                <input type="submit" value="Submit">
              </form>

              <table id="data" class="table table-bordered">
                  <thead class="thead">
                      <tr>
                          <th>Agent</th>
                          <th>Status</th>
                          <th>Timestamp</th>
                      </tr>
                  </thead>
                  <tbody>
                  {% for status_row in port_status %}
                      <tr>
                        <td>{{ status_row.agent }}</td>
                        <td>{{ status_row.status }}</td>
                        <td>{{ status_row.timestamp | date:"l, d M Y H:i:s" }}</td>
                      </tr>
                  {% endfor %}
                  </tbody>
                  <tfoot>
                    <tr>
                      <th></th>
                      <th></th>
                      <th></th>
                    </tr>
                  </tfoot>
              </table>

              <nav aria-label="Page navigation example">
              {% if port_status.has_other_pages %}
                <ul class="pagination">
                  {% if port_status.has_previous %}
                    <li>
                      <a class="page-link" href="{% url 'table' %}?ip={{ ip }}&port={{ port }}&page={{ port_status.previous_page_number }}">&laquo;</a>
                    </li>
                  {% else %}
                    <li class="disabled">
                      <span aria-hidden="true">&laquo;</span>
                    </li>
                  {% endif %}
                  {% for i in port_status.paginator.page_range %}
                    {% if port_status.number == i %}
                      <li class="page-item active">
                        <span>
                          <a class="page-link">
                            {{ i }}<span class="sr-only">(current)</span>
                          </a>
                        </span>
                      </li>
                    {% else %}
                      <li class="page-item">
                        <a class="page-link" href="{% url 'table' %}?ip={{ ip }}&port={{ port }}&page={{ i }}">{{ i }}</a>
                      </li>
                    {% endif %}
                  {% endfor %}
                  {% if port_status.has_next %}
                    <li>
                      <a class="page-link" href="{% url 'table' %}?ip={{ ip }}&port={{ port }}&page={{ port_status.next_page_number }}">&raquo;</a>
                    </li>
                  {% else %}
                    <li class="disabled">
                      <span>&raquo;</span>
                    </li>
                  {% endif %}
                </ul>
              {% endif %}
              </nav>
          {% else %}
            <div class="container">
              <div class="jumbotron">
                <h1 class="display-3">No status report, Sir</h1>
                <p class="lead">Try reloading the page or check the database</p>
              </div>
            </div>
          {% endif %}
    {% endblock %}
